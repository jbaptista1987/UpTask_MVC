!function(){let e=[],a=[];const t=document.createElement("DIV");function n(){!function(){const e=document.querySelector("#listado_tareas");for(;e.firstChild;)e.removeChild(e.firstChild)}();const t={0:"Pendiente",1:"Completada"},c=document.querySelector("#listado_tareas"),i=document.createElement("LI");i.classList.add("tarea"),i.classList.add("textoCentrado");const l=document.createElement("P");l.textContent="Tarea";const d=document.createElement("P");d.textContent="Fecha Prevista Fin";const s=document.createElement("P");s.textContent="Fecha Real Fin";const u=document.createElement("P");u.textContent="Acciones",i.appendChild(l),i.appendChild(d),i.appendChild(s),i.appendChild(u),c.appendChild(i),function(){let a=e.filter(e=>"0"==e.Estado);const t=document.querySelector("#filtroPendientes");"0"==a.length?t.disabled=!0:t.disabled=!1}(),function(){let a=e.filter(e=>"1"==e.Estado);const t=document.querySelector("#filtroCompletadas");"0"==a.length?t.disabled=!0:t.disabled=!1}();let m=a.length?a:e;if(m.length>0)m.forEach(a=>{const i=document.createElement("LI");i.dataset.tareaID=a.ID,i.classList.add("tarea");let l=document.createElement("P");l.textContent=a.Tarea,l.ondblclick=function(){o(!0,a)};let d=document.createElement("P");d.textContent=FechaFormateada(a.Fecha_Prevista_Fin),d.classList.add("textoCentrado");let s=document.createElement("P"),u="";u="0000-00-00"===a.Fecha_Real_Fin?"Sin Finalizar":FechaFormateada(a.Fecha_Real_Fin),s.textContent=u,s.classList.add("textoCentrado");const m=document.createElement("DIV");m.classList.add("opciones");const p=document.createElement("BUTTON");p.classList.add("estado_tarea"),p.classList.add(""+t[a.Estado]),p.textContent=t[a.Estado],p.dataset.estadoTarea=a.Estado,p.ondblclick=function(){!function(a){Swal.fire({title:"<strong>Fianlizar Tarea</strong>",icon:"info",html:'\n              <label for="Fecha_Real_Fin">Fecha Real Fin:</label>\n              <input type="date" name="Fecha_Real_Fin" id="Fecha_Real_Fin" maxlength="10">\n            ',showCloseButton:!0,showCancelButton:!0,focusConfirm:!0,confirmButtonText:'\n              <i class="fa fa-thumbs-up"> Ok </i>\n            ',confirmButtonAriaLabel:"Thumbs up, great!",cancelButtonText:'\n              <i class="fa fa-thumbs-down"> No </i>\n            ',cancelButtonAriaLabel:"Thumbs down",willOpen:()=>{Swal.getConfirmButton().addEventListener("click",()=>{""!==document.querySelector("#Fecha_Real_Fin").value&&(a.Fecha_Real_Fin=document.querySelector("#Fecha_Real_Fin").value,function(a){let t="0"===a.Estado?"1":"0";a.Estado=t,async function(a){const{ID:t,Tarea:o,ProyectoID:c,Fecha_Prevista_Fin:i,Fecha_Real_Fin:l,Estado:d}=a,s=new FormData;s.append("ID",t),s.append("Tarea",o),s.append("ProyectoID",c),s.append("Fecha_Prevista_Fin",i),s.append("Fecha_Real_Fin",l),s.append("Estado",d),s.append("Codigo",r());try{const a=await fetch("http://localhost:3000/api/tareas/actualizar",{method:"POST",body:s});let o=await a.json();if(console.log(o),"error"===o.Tipo)return void mostrarAlerta(o.Mensaje,o.Tipo,document.querySelector("#mensaje"));"msjExito"===o.Tipo&&(mostrarAlerta(o.Mensaje,o.Tipo,document.querySelector("#mensaje")),setTimeout(()=>document.querySelector(".errorLlenado").remove(),2500),e=e.map(e=>(e.ID===t&&(e.Estado=d,e.Fecha_Prevista_Fin=i,e.Fecha_Real_Fin=i),e)),n())}catch(e){console.log(e)}}(a)}(a))})}})}({...a})};const h=document.createElement("BUTTON");h.classList.add("eliminar_tarea"),h.dataset.tareaID=a.ID,h.textContent="Eliminar",h.ondblclick=function(){var t;t={...a},Swal.fire({title:"多Desea eliminar la Tarea?",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(a=>{a.isConfirmed&&async function(a){const{ID:t}=a,o=new FormData;o.append("ID",t),o.append("Codigo",r());try{const a=await fetch("http://localhost:3000/api/tareas/eliminar",{method:"POST",body:o});let r=await a.json();if(console.log(r),"error"===r.Tipo)return void mostrarAlerta(r.Mensaje,r.Tipo,document.querySelector("#mensaje"));"msjExito"===r.Tipo&&(Swal.fire("Eliminada!",r.Mensaje,"success"),e=e.filter(e=>e.ID!==t),n())}catch(e){console.log(e)}}(t)}).catch(e=>{console.log(e)})},m.appendChild(p),m.appendChild(h),i.appendChild(l),i.appendChild(d),i.appendChild(s),i.appendChild(m),c.appendChild(i)});else{const e=document.createElement("LI");e.textContent="No Hay Tareas Asignadas al Presente Proyecto",e.classList.add("no_tarea"),c.appendChild(e)}}!async function(){try{const a="http://localhost:3000/api/tareas?Codigo="+r(),t=await fetch(a),o=await t.json();e=o,n()}catch(e){console.log(e)}}();function o(a=!1,o={}){t.classList.add("modal"),t.innerHTML=`\n            <form class="formulario nueva_tarea">\n                <legend>${a?"Editar la Tarea":"A単ade una Nueva Tarea"}</legend>\n                <div class="campo">\n                    <label for="Tarea">Tarea:</label>\n                    <input type="text" name="Tarea" id="Tarea" placeholder="Tarea a Realizar" value="${o.Tarea?o.Tarea:""}"/>\n                </div>\n                <div class="campo">\n                    <label for="Fecha_Prevista_Fin">Fecha Prevista Fin:</label>\n                    <input type="date" name="Fecha_Prevista_Fin" id="Fecha_Prevista_Fin" value="${o.Fecha_Prevista_Fin?o.Fecha_Prevista_Fin:""}"/>\n                </div>\n                <div id="mensajeModal"></div>\n                <div class="opciones">\n                    <input type="submit" class="submit_nueva_tarea" value="${a?"Editar Tarea":"A単adir Tarea"}">\n                    <button type="button" class="cerrar_modal">Cerrar</button>\n                </div>\n            </form>\n        `,setTimeout(()=>{document.querySelector(".formulario").classList.add("animar")},100),t.addEventListener("click",(function(a){if(a.preventDefault(),a.target.classList.contains("cerrar_modal")){document.querySelector(".formulario").classList.add("cerrar"),setTimeout(()=>{t.remove()},1e3)}if(a.target.classList.contains("submit_nueva_tarea")&&"Editar Tarea"===a.target.value){let a=document.querySelector("#Tarea").value.trim(),c=document.querySelector("#Fecha_Prevista_Fin").value;!function(a,o,c,i,l,d){if(""===i)return void mostrarAlerta("El Nombre de la Tarea de Obligatorio","error",document.querySelector("#mensajeModal"));document.querySelector(".errorLlenado")&&document.querySelector(".errorLlenado").remove(),async function(a,o,c,i,l,d){const s=new FormData;s.append("ID",a),s.append("Tarea",i),s.append("ProyectoID",o),s.append("Fecha_Prevista_Fin",l),s.append("Fecha_Real_Fin",d),s.append("Estado",c),s.append("Codigo",r());try{const o=await fetch("http://localhost:3000/api/tareas/actualizar",{method:"POST",body:s});let r=await o.json();if("error"===r.Tipo)return void mostrarAlerta(r.Mensaje,r.Tipo,document.querySelector("#mensaje"));"msjExito"===r.Tipo&&(mostrarAlerta(r.Mensaje,r.Tipo,document.querySelector("#mensajeModal")),setTimeout(()=>{document.querySelector(".errorLlenado").remove(),t.remove()},2500),e=e.map(e=>(e.ID===a&&(e.Tarea=i,e.Fecha_Prevista_Fin=l,e.Fecha_Real_Fin=d),e)),n())}catch(e){console.log(e)}}(a,o,c,i,l,d)}(o.ID,o.ProyectoID,o.Estado,a,c,o.Fecha_Real_Fin)}a.target.classList.contains("submit_nueva_tarea")&&"A単adir Tarea"===a.target.value&&function(){let a=document.querySelector("#Tarea").value.trim(),o=document.querySelector("#Fecha_Prevista_Fin").value;if(""===a)return void mostrarAlerta("El Nombre de la Tarea de Obligatorio","error",document.querySelector("#mensajeModal"));document.querySelector(".errorLlenado")&&document.querySelector(".errorLlenado").remove(),async function(a,o){try{const c=new FormData;c.append("Tarea",a),c.append("Fecha_Prevista_Fin",o),c.append("Fecha_Real_Fin","0000-00-00"),c.append("Codigo",r());const i="http://localhost:3000/api/tareas",l=await fetch(i,{method:"POST",body:c}),d=await l.json();if(console.log(d),"msjExito"===d.Tipo){mostrarAlerta(d.Mensaje,d.Tipo,document.querySelector("#mensajeModal")),setTimeout(()=>{t.remove()},1500);let o={ID:d.ID,Tarea:a,Fecha_Prevista_Fin:d.Fecha_Prevista_Fin,Fecha_Real_Fin:d.Fecha_Real_Fin,Estado:0,ProyectoID:d.ProyectoID};e=[...e,o],n()}}catch(e){console.log(e)}}(a,o)}()})),document.querySelector(".dashboard").appendChild(t)}function r(){return Object.fromEntries(new URLSearchParams(window.location.search)).Codigo}function c(t){let o=t.target.value;a=""!==o?e.filter(e=>e.Estado==o):[],n()}document.querySelector("#agregar_tarea").addEventListener("click",(function(){o(!1)})),document.querySelectorAll('#filtros input[type="radio"]').forEach(e=>{e.addEventListener("input",c)})}();